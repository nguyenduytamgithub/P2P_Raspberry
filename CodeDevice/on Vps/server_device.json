[{"id":"667c16ce.db1ec8","type":"ui_button","z":"4e472904.6e8aa8","name":"","group":"97776fd3.6b0ac","order":3,"width":"3","height":"1","passthru":false,"label":"Scan","tooltip":"","color":"","bgcolor":"","icon":"","payload":"scan","payloadType":"str","topic":"","x":250,"y":180,"wires":[[]]},{"id":"5b10b9be.362628","type":"ui_button","z":"4e472904.6e8aa8","name":"","group":"97776fd3.6b0ac","order":4,"width":"3","height":"1","passthru":false,"label":"Connect","tooltip":"","color":"","bgcolor":"","icon":"","payload":"scan","payloadType":"str","topic":"","x":220,"y":220,"wires":[["f77a3bf6.059948"]]},{"id":"27690434.e402bc","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>IP address</i>","tooltip":"","group":"97776fd3.6b0ac","order":1,"width":0,"height":0,"passthru":true,"mode":"text","delay":300,"topic":"","x":290,"y":140,"wires":[["d6a5416.aabdfc"]]},{"id":"39b6a28c.648bbe","type":"ui_text","z":"4e472904.6e8aa8","group":"97776fd3.6b0ac","order":2,"width":0,"height":0,"name":"","label":"Status: ","format":"<i>{{msg.payload}}</i>","layout":"row-spread","x":830,"y":280,"wires":[]},{"id":"74d1ded4.a81c3","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>Phone number</i>","tooltip":"","group":"de7fa929.04a868","order":1,"width":0,"height":0,"passthru":false,"mode":"number","delay":300,"topic":"","x":490,"y":420,"wires":[["8e160f1f.cea3"]]},{"id":"e5488b50.7a5ab8","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>Password</i>","tooltip":"","group":"de7fa929.04a868","order":2,"width":0,"height":0,"passthru":true,"mode":"password","delay":300,"topic":"","x":470,"y":460,"wires":[["5979c902.78cc58"]]},{"id":"fa13b6d7.1b4388","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>Password confirm</i>","tooltip":"","group":"de7fa929.04a868","order":3,"width":0,"height":0,"passthru":true,"mode":"password","delay":300,"topic":"","x":490,"y":500,"wires":[["291603fb.34ad3c"]]},{"id":"f104fbdc.ce8e98","type":"ui_button","z":"4e472904.6e8aa8","name":"","group":"de7fa929.04a868","order":6,"width":"0","height":"0","passthru":false,"label":"Register","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":100,"y":620,"wires":[["72c32330.aa8cec"]]},{"id":"563edaba.fce524","type":"ui_ui_control","z":"4e472904.6e8aa8","name":"","x":100,"y":460,"wires":[["578689e2.226f88","8a9ee4d7.6dd378","ade8d668.ca0958"]]},{"id":"578689e2.226f88","type":"function","z":"4e472904.6e8aa8","name":"blank box","func":"msg.payload = \"\"\nreturn msg;","outputs":1,"noerr":0,"x":260,"y":460,"wires":[["e5488b50.7a5ab8","fa13b6d7.1b4388","e6480002.54373","74d1ded4.a81c3"]]},{"id":"8e160f1f.cea3","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"tk","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"mk","pt":"msg","to":"mk","tot":"flow"},{"t":"set","p":"payload","pt":"msg","to":"mk_cf","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":420,"wires":[["c83ab28f.e680f"]]},{"id":"5979c902.78cc58","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"mk","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"mk","pt":"msg","to":"mk_cf","tot":"flow"},{"t":"set","p":"tk","pt":"msg","to":"tk","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":700,"y":460,"wires":[["c83ab28f.e680f"]]},{"id":"b4e704c7.5c6be8","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1070.0000267028809,"y":629.9999980926514,"wires":[]},{"id":"915c98f9.f2eb18","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1076,"y":498,"wires":[]},{"id":"7b9166bc.da3f88","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"packet.tk","pt":"msg","to":"tk","tot":"flow"},{"t":"set","p":"packet.mk","pt":"msg","to":"mk","tot":"flow"},{"t":"set","p":"match","pt":"msg","to":"match","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":550,"y":620,"wires":[["e8d3a097.4141"]]},{"id":"72c32330.aa8cec","type":"function","z":"4e472904.6e8aa8","name":"create json","func":"msg.packet = {\n}\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":620,"wires":[["7b9166bc.da3f88"]]},{"id":"a6fbab5f.acd918","type":"function","z":"4e472904.6e8aa8","name":"sent","func":"msg.payload = msg.packet\nreturn msg;","outputs":1,"noerr":0,"x":865,"y":640,"wires":[["b4e704c7.5c6be8","12f9b23e.7f9ade"]]},{"id":"291603fb.34ad3c","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"mk","pt":"msg","to":"mk","tot":"flow"},{"t":"set","p":"mk_cf","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"tk","pt":"msg","to":"tk","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":500,"wires":[["c83ab28f.e680f"]]},{"id":"c83ab28f.e680f","type":"function","z":"4e472904.6e8aa8","name":"check","func":"\nif (msg.tk === \"\"){\n    msg.payload = \"\"\n    flow.set(\"match\", false)\n}else{\n    if (msg.mk === \"\"){\n        msg.payload = \"\"\n        flow.set(\"match\", false)\n    }else if (msg.payload !== msg.mk){\n        msg.payload = \"not match\"\n        flow.set(\"match\", false)\n    }else if (msg.payload == msg.mk){\n        msg.payload = \"match\"\n        flow.set(\"match\", true)\n    }else{\n        msg.payload = \"\"\n        flow.set(\"match\", false)\n    }\n        \n}\nreturn msg;\n","outputs":1,"noerr":0,"x":940,"y":460,"wires":[["915c98f9.f2eb18","29d81f92.bfe46"]]},{"id":"29d81f92.bfe46","type":"ui_text","z":"4e472904.6e8aa8","group":"de7fa929.04a868","order":5,"width":0,"height":0,"name":"","label":"","format":"<i>{{msg.payload}}</i>","layout":"row-spread","x":1097,"y":457,"wires":[]},{"id":"8a9ee4d7.6dd378","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"mk","pt":"flow","to":"\"\"","tot":"env"},{"t":"set","p":"mk_cf","pt":"flow","to":"\"\"","tot":"env"},{"t":"set","p":"tk","pt":"flow","to":"\"\"","tot":"env"},{"t":"set","p":"match","pt":"flow","to":"false","tot":"bool"},{"t":"set","p":"payload","pt":"msg","to":"ip","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":400,"wires":[["27690434.e402bc"]]},{"id":"e8d3a097.4141","type":"switch","z":"4e472904.6e8aa8","name":"","property":"match","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":719,"y":618,"wires":[["12f042ae.99c14d"],["a6fbab5f.acd918","7a7885eb.d01a0c"]]},{"id":"12f042ae.99c14d","type":"function","z":"4e472904.6e8aa8","name":"check again","func":"msg.payload = \"please check again\"\nreturn msg;","outputs":1,"noerr":0,"x":864,"y":598,"wires":[["29d81f92.bfe46","9d2dc9c3.5c5438"]]},{"id":"9d2dc9c3.5c5438","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1062,"y":585,"wires":[]},{"id":"7a7885eb.d01a0c","type":"function","z":"4e472904.6e8aa8","name":"ok","func":"msg.payload = \"registing...\"\nreturn msg;","outputs":1,"noerr":0,"x":868,"y":681,"wires":[["29d81f92.bfe46"]]},{"id":"e6480002.54373","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>Email</i>","tooltip":"","group":"de7fa929.04a868","order":4,"width":0,"height":0,"passthru":true,"mode":"text","delay":300,"topic":"","x":450,"y":540,"wires":[[]]},{"id":"1accf3c.365d10c","type":"ui_ui_control","z":"4e472904.6e8aa8","name":"","x":100,"y":780,"wires":[["a1336c8e.0e6d1","fe14febd.1805d"]]},{"id":"a1336c8e.0e6d1","type":"function","z":"4e472904.6e8aa8","name":"blank box","func":"msg.payload = \"\"\nreturn msg;","outputs":1,"noerr":0,"x":240,"y":860,"wires":[["7398985a.0ab2e8","904d943b.f31a68"]]},{"id":"fe14febd.1805d","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"mk","pt":"flow","to":"\"\"","tot":"env"},{"t":"set","p":"tk","pt":"flow","to":"\"\"","tot":"env"},{"t":"set","p":"accept","pt":"flow","to":"\"\"","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":274,"y":710,"wires":[[]]},{"id":"7398985a.0ab2e8","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>Phone number</i>","tooltip":"","group":"753ed078.f7259","order":1,"width":0,"height":0,"passthru":false,"mode":"number","delay":300,"topic":"","x":424,"y":760,"wires":[["1c17b600.6978ea","c9c2168b.6720a8"]]},{"id":"904d943b.f31a68","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>Password</i>","tooltip":"","group":"753ed078.f7259","order":2,"width":0,"height":0,"passthru":true,"mode":"password","delay":300,"topic":"","x":434,"y":800,"wires":[["7438d944.65e8f8","c9c2168b.6720a8"]]},{"id":"1c17b600.6978ea","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"tk","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"mk","pt":"msg","to":"mk","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":704,"y":740,"wires":[["6d60a1a1.c7007"]]},{"id":"c9c2168b.6720a8","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":624,"y":700,"wires":[]},{"id":"7438d944.65e8f8","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"mk","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"tk","pt":"msg","to":"tk","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":704,"y":780,"wires":[["6d60a1a1.c7007"]]},{"id":"6d60a1a1.c7007","type":"function","z":"4e472904.6e8aa8","name":"check","func":"flow.set(\"accept\", false)\nif (msg.tk !== \"\" && msg.mk !== \"\")\n    flow.set(\"accept\", true)\nmsg.payload = \"\"\nreturn msg;\n","outputs":1,"noerr":0,"x":874,"y":800,"wires":[["ab34d565.2e0d88","b946d9c.7560428"]]},{"id":"ab34d565.2e0d88","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1010,"y":838,"wires":[]},{"id":"b946d9c.7560428","type":"ui_text","z":"4e472904.6e8aa8","group":"753ed078.f7259","order":3,"width":0,"height":0,"name":"","label":"","format":"<i>{{msg.payload}}</i>","layout":"row-spread","x":1031,"y":797,"wires":[]},{"id":"211cd504.575e7a","type":"function","z":"4e472904.6e8aa8","name":"check again","func":"msg.payload = \"please check again\"\nreturn msg;","outputs":1,"noerr":0,"x":798,"y":938,"wires":[["b946d9c.7560428","e94a0036.b9804"]]},{"id":"f5ec45be.d3e488","type":"function","z":"4e472904.6e8aa8","name":"ok","func":"msg.payload = \"loging...\"\nreturn msg;","outputs":1,"noerr":0,"x":802,"y":1021,"wires":[["b946d9c.7560428"]]},{"id":"7f759a7.074f564","type":"switch","z":"4e472904.6e8aa8","name":"","property":"accept","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":653,"y":958,"wires":[["211cd504.575e7a"],["8bd7388c.e6c068","f5ec45be.d3e488"]]},{"id":"e94a0036.b9804","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":996,"y":925,"wires":[]},{"id":"24a41595.0dd2aa","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"packet.tk","pt":"msg","to":"tk","tot":"flow"},{"t":"set","p":"packet.mk","pt":"msg","to":"mk","tot":"flow"},{"t":"set","p":"accept","pt":"msg","to":"accept","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":484,"y":960,"wires":[["7f759a7.074f564"]]},{"id":"8bd7388c.e6c068","type":"function","z":"4e472904.6e8aa8","name":"sent","func":"msg.payload = msg.packet\nreturn msg;","outputs":1,"noerr":0,"x":799,"y":980,"wires":[["5b701320.41a85c","41e25b25.2c5734"]]},{"id":"5f69cde0.d604f4","type":"function","z":"4e472904.6e8aa8","name":"create json","func":"msg.packet = {\n}\nreturn msg;","outputs":1,"noerr":0,"x":313,"y":959,"wires":[["24a41595.0dd2aa"]]},{"id":"5b701320.41a85c","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1004,"y":1019,"wires":[]},{"id":"58541cb9.432c94","type":"ui_button","z":"4e472904.6e8aa8","name":"","group":"753ed078.f7259","order":4,"width":"3","height":"1","passthru":false,"label":"Login","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":103,"y":960,"wires":[["5f69cde0.d604f4"]]},{"id":"ebdce876.47ce48","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>Phone number</i>","tooltip":"","group":"6e09eb8b.2384d4","order":1,"width":0,"height":0,"passthru":false,"mode":"number","delay":300,"topic":"","x":181,"y":1207,"wires":[["53268900.fbb928"]]},{"id":"60d2a007.dd8f5","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>Message</i>","tooltip":"","group":"6e09eb8b.2384d4","order":3,"width":0,"height":0,"passthru":false,"mode":"text","delay":300,"topic":"","x":149,"y":1305,"wires":[["f6fa07c2.012348"]]},{"id":"a008703.131549","type":"ui_text_input","z":"4e472904.6e8aa8","name":"","label":"<i>Money</i>","tooltip":"","group":"6e09eb8b.2384d4","order":2,"width":0,"height":0,"passthru":false,"mode":"number","delay":300,"topic":"","x":150,"y":1250,"wires":[["45208b7f.333574"]]},{"id":"f3d7e332.180ad","type":"ui_button","z":"4e472904.6e8aa8","name":"","group":"6e09eb8b.2384d4","order":5,"width":"0","height":"0","passthru":false,"label":"Sent","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":116,"y":1390.999963760376,"wires":[["648779f2.f97e18"]]},{"id":"8cee26ea.e58de8","type":"ui_text","z":"4e472904.6e8aa8","group":"6e09eb8b.2384d4","order":4,"width":0,"height":0,"name":"","label":"","format":"<i>{{msg.payload}}</i>","layout":"row-spread","x":790,"y":1260,"wires":[]},{"id":"7d7ba805.072918","type":"inject","z":"4e472904.6e8aa8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":1280,"y":60,"wires":[["3102a181.fdacce"]]},{"id":"3102a181.fdacce","type":"function","z":"4e472904.6e8aa8","name":"","func":"msg.headers = {\n         \"Content-type\" : \"application/json\",\n         \"Node-RED-Deployment-Type\": \"reload\"\n     }\nmsg.payload = {};\n     return msg;","outputs":1,"noerr":0,"x":1450,"y":60,"wires":[["cdd95303.73201","a1d82830.271138"]]},{"id":"cdd95303.73201","type":"http request","z":"4e472904.6e8aa8","name":"","method":"POST","ret":"txt","url":"http://localhost:1880/flows","tls":"","x":1610,"y":60,"wires":[["bf6d3a87.adff78"]]},{"id":"bf6d3a87.adff78","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1780,"y":60,"wires":[]},{"id":"ef3ec13b.25e4d","type":"file in","z":"4e472904.6e8aa8","name":"","filename":"","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1070,"y":200,"wires":[["97b4c790.367378"]]},{"id":"97b4c790.367378","type":"json","z":"4e472904.6e8aa8","name":"","property":"payload","action":"","pretty":false,"x":1190,"y":200,"wires":[["f0cc782e.4fdf08"]]},{"id":"1aa492c5.42ab8d","type":"function","z":"4e472904.6e8aa8","name":"direction","func":"msg.filename = \"C:/Users/nguye/.node-red/flows_\" + msg.payload + \".json\"\nreturn msg;","outputs":1,"noerr":0,"x":940,"y":200,"wires":[["ef3ec13b.25e4d"]]},{"id":"fd48cce0.b4757","type":"exec","z":"4e472904.6e8aa8","command":"hostname","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":800,"y":200,"wires":[["1aa492c5.42ab8d"],[],[]]},{"id":"f0cc782e.4fdf08","type":"function","z":"4e472904.6e8aa8","name":"change server","func":"for(var x = 0; x < msg.payload.length; x++){\n    var obj = msg.payload[x]\n    if(obj['id'] == \"elefos_server_client\")\n        obj['broker'] = msg.ip\n}\nreturn msg;","outputs":1,"noerr":0,"x":1340,"y":200,"wires":[["ff220977.196638"]]},{"id":"f77a3bf6.059948","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"ip","pt":"msg","to":"ip","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":220,"wires":[["5ad53f42.2f861"]]},{"id":"d6a5416.aabdfc","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"ip","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":140,"wires":[[]]},{"id":"5ad53f42.2f861","type":"switch","z":"4e472904.6e8aa8","name":"","property":"ip","propertyType":"msg","rules":[{"t":"eq","v":"\"\"","vt":"env"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":200,"wires":[["c100db98.ce1f38","88e9f9bf.248848"],["fd48cce0.b4757","85aeb4af.9e8818"]]},{"id":"88e9f9bf.248848","type":"function","z":"4e472904.6e8aa8","name":"error ip","func":"msg.payload = \"Please scan or input ip\"\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":160,"wires":[["39b6a28c.648bbe"]]},{"id":"85aeb4af.9e8818","type":"function","z":"4e472904.6e8aa8","name":"connecting","func":"msg.payload = \"Connecting...\"\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":240,"wires":[["39b6a28c.648bbe"]]},{"id":"c100db98.ce1f38","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"ip","targetType":"msg","x":620,"y":120,"wires":[]},{"id":"ff220977.196638","type":"file","z":"4e472904.6e8aa8","name":"","filename":"","appendNewline":false,"createDir":false,"overwriteFile":"true","encoding":"none","x":1510,"y":200,"wires":[["3102a181.fdacce"]]},{"id":"78f8688e.3c5228","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1190,"y":360,"wires":[]},{"id":"8e374c14.4ca4e","type":"status","z":"4e472904.6e8aa8","name":"","scope":["57c2be1c.e51ec"],"x":640,"y":360,"wires":[["e18908bd.4eddb8"]]},{"id":"380b4b9e.501d34","type":"function","z":"4e472904.6e8aa8","name":"status","func":"if (msg.status.fill === \"yellow\")\n    msg.payload = \"Connection fail\"\nelse if (msg.status.fill === \"green\")\n    msg.payload = \"Connected\"\nelse if (msg.status.fill === \"red\")\n    msg.payload = \"Connection fail\"\nelse\n    msg.payload = \"Connecting...\"\nreturn msg;","outputs":1,"noerr":0,"x":1030,"y":360,"wires":[["78f8688e.3c5228","39b6a28c.648bbe"]]},{"id":"a1d82830.271138","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1603.9999961853027,"y":18.999998092651367,"wires":[]},{"id":"ade8d668.ca0958","type":"function","z":"4e472904.6e8aa8","name":"waiting","func":"msg.payload = \"Waiting...\"\nreturn msg;","outputs":1,"noerr":0,"x":640,"y":320,"wires":[["39b6a28c.648bbe"]]},{"id":"12f9b23e.7f9ade","type":"mqtt out","z":"4e472904.6e8aa8","name":"","topic":"registered","qos":"","retain":"","broker":"6dab62ed.cafdcc","x":1060.0000267028809,"y":672.0000591278076,"wires":[]},{"id":"e18908bd.4eddb8","type":"delay","z":"4e472904.6e8aa8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":860,"y":360,"wires":[["380b4b9e.501d34"]]},{"id":"7a3bdb13.1bf444","type":"mqtt in","z":"4e472904.6e8aa8","name":"","topic":"elefos_feedback_status","qos":"2","datatype":"auto","broker":"6dab62ed.cafdcc","x":1230,"y":400,"wires":[["29d81f92.bfe46","a93a5465.6859b8"]]},{"id":"a93a5465.6859b8","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1450,"y":400,"wires":[]},{"id":"53268900.fbb928","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"to","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"data","pt":"msg","to":"data","tot":"flow"},{"t":"set","p":"to","pt":"msg","to":"to","tot":"flow"},{"t":"set","p":"user_login","pt":"msg","to":"user_login","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":1200,"wires":[["44feabef.03fe54"]]},{"id":"45208b7f.333574","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"data","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"data","pt":"msg","to":"data","tot":"flow"},{"t":"set","p":"to","pt":"msg","to":"to","tot":"flow"},{"t":"set","p":"user_login","pt":"msg","to":"user_login","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":406.01422119140625,"y":1239.2784423828125,"wires":[["44feabef.03fe54"]]},{"id":"f6fa07c2.012348","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"msg","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":396.01422119140625,"y":1300.2785186767578,"wires":[["44feabef.03fe54"]]},{"id":"44feabef.03fe54","type":"function","z":"4e472904.6e8aa8","name":"check","func":"flow.set(\"accept\", false)\nif (msg.to !== \"\" && msg.data !== \"\"){\n    if (msg.user_login !== \"\")\n        flow.set(\"accept\", true)\n}\nmsg.payload = \"\"\nreturn msg;\n","outputs":1,"noerr":0,"x":587.0142211914062,"y":1251.2784423828125,"wires":[["8cee26ea.e58de8","bdc4199f.b15d58"]]},{"id":"1a6f5f51.bce571","type":"ui_ui_control","z":"4e472904.6e8aa8","name":"","x":113,"y":1135.2784423828125,"wires":[["384798ce.743ed8","ab4a4d3f.195d7"]]},{"id":"384798ce.743ed8","type":"function","z":"4e472904.6e8aa8","name":"blank box","func":"msg.payload = \"\"\nreturn msg;","outputs":1,"noerr":0,"x":279.0142059326172,"y":1127.2784423828125,"wires":[["ebdce876.47ce48","a008703.131549","60d2a007.dd8f5","8cee26ea.e58de8"]]},{"id":"a5efad0f.e9076","type":"function","z":"4e472904.6e8aa8","name":"account","func":"msg.packet.issuer = msg.user_login\nmsg.payload = msg.packet\nreturn msg;","outputs":1,"noerr":0,"x":780,"y":1380,"wires":[["81956ad4.3aa0a8","fada2c35.974f7"]]},{"id":"648779f2.f97e18","type":"function","z":"4e472904.6e8aa8","name":"create json","func":"msg.packet = {\n}\nreturn msg;","outputs":1,"noerr":0,"x":271.0142059326172,"y":1387.1875,"wires":[["c1a2b601.d261e8"]]},{"id":"c1a2b601.d261e8","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"packet.payload.receiver","pt":"msg","to":"to","tot":"flow"},{"t":"set","p":"packet.payload.cmd","pt":"msg","to":"msg","tot":"flow"},{"t":"set","p":"packet.payload.data","pt":"msg","to":"data","tot":"flow"},{"t":"set","p":"accept","pt":"msg","to":"accept","tot":"flow"},{"t":"set","p":"user_login","pt":"msg","to":"user_login","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":446.01422119140625,"y":1388.1875,"wires":[["2ee1601a.1dd77"]]},{"id":"81956ad4.3aa0a8","type":"mqtt out","z":"4e472904.6e8aa8","name":"","topic":"transaction","qos":"","retain":"","broker":"374a5c6a.9a5f24","x":972.014274597168,"y":1389.1874685287476,"wires":[]},{"id":"2ee1601a.1dd77","type":"switch","z":"4e472904.6e8aa8","name":"","property":"accept","propertyType":"msg","rules":[{"t":"false"},{"t":"true"}],"checkall":"true","repair":false,"outputs":2,"x":604.0142211914062,"y":1389.2784423828125,"wires":[["cef228c3.3df948"],["a5efad0f.e9076","45dcc642.fc4468"]]},{"id":"cef228c3.3df948","type":"function","z":"4e472904.6e8aa8","name":"check again","func":"msg.payload = \"please check again\"\nreturn msg;","outputs":1,"noerr":0,"x":742.0142211914062,"y":1334.2784423828125,"wires":[["8cee26ea.e58de8","fada2c35.974f7"]]},{"id":"fada2c35.974f7","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":950,"y":1320,"wires":[]},{"id":"ab4a4d3f.195d7","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"to","pt":"flow","to":"\"\"","tot":"env"},{"t":"set","p":"msg","pt":"flow","to":"\"\"","tot":"env"},{"t":"set","p":"accept","pt":"flow","to":"false","tot":"bool"},{"t":"set","p":"data","pt":"flow","to":"\"\"","tot":"env"},{"t":"set","p":"user_login","pt":"msg","to":"user_login","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":262.0142059326172,"y":1068.460205078125,"wires":[[]]},{"id":"bdc4199f.b15d58","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":761.7840423583984,"y":1180.9147415161133,"wires":[]},{"id":"45dcc642.fc4468","type":"function","z":"4e472904.6e8aa8","name":"ok","func":"msg.payload = \"sent success\"\nreturn msg;","outputs":1,"noerr":0,"x":730,"y":1440,"wires":[["8cee26ea.e58de8"]]},{"id":"6c084b28.b5c984","type":"json","z":"4e472904.6e8aa8","name":"","property":"payload","action":"","pretty":false,"x":386.76704025268555,"y":1602.4545164108276,"wires":[["394dfaba.554c26"]]},{"id":"982ce41.a32ce18","type":"mqtt in","z":"4e472904.6e8aa8","name":"","topic":"elefos_feedback_transaction","qos":"2","datatype":"auto","broker":"374a5c6a.9a5f24","x":200,"y":1600,"wires":[["6c084b28.b5c984"]]},{"id":"394dfaba.554c26","type":"function","z":"4e472904.6e8aa8","name":"convert receiver","func":"msg.topic = msg.payload.payload.receiver.toString()\nreturn msg;","outputs":1,"noerr":0,"x":541.7783813476562,"y":1595.3238525390625,"wires":[["a918ad34.05ea9","81ad6424.6f49e8"]]},{"id":"a918ad34.05ea9","type":"mqtt out","z":"4e472904.6e8aa8","name":"","topic":"","qos":"","retain":"","broker":"7b2d6644.1dbe08","x":717,"y":1597,"wires":[]},{"id":"81ad6424.6f49e8","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":755.7869262695312,"y":1660.460153579712,"wires":[]},{"id":"41e25b25.2c5734","type":"mqtt out","z":"4e472904.6e8aa8","name":"","topic":"login","qos":"","retain":"","broker":"374a5c6a.9a5f24","x":970,"y":980,"wires":[]},{"id":"c530789.42de488","type":"mqtt in","z":"4e472904.6e8aa8","name":"","topic":"elefos_feedback_login","qos":"2","datatype":"auto","broker":"374a5c6a.9a5f24","x":1000,"y":740,"wires":[["a529a7fb.0deea8"]]},{"id":"74631ce3.df6e24","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1330,"y":700,"wires":[]},{"id":"a529a7fb.0deea8","type":"json","z":"4e472904.6e8aa8","name":"","property":"payload","action":"","pretty":false,"x":1190,"y":740,"wires":[["74631ce3.df6e24","a3877ad1.236988"]]},{"id":"a3877ad1.236988","type":"function","z":"4e472904.6e8aa8","name":"convert","func":"msg.packet = msg.payload\nmsg.payload = msg.packet.cmd\nreturn msg;","outputs":1,"noerr":0,"x":1320,"y":740,"wires":[["b946d9c.7560428","84c19bdd.1d6f98","884f9fb5.267e8"]]},{"id":"84c19bdd.1d6f98","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"user_login","pt":"flow","to":"packet.user_id","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1550,"y":740,"wires":[[]]},{"id":"57c2be1c.e51ec","type":"mqtt in","z":"4e472904.6e8aa8","name":"","topic":"status","qos":"2","datatype":"auto","broker":"elefos_server_client","x":790,"y":120,"wires":[[]]},{"id":"884f9fb5.267e8","type":"switch","z":"4e472904.6e8aa8","name":"","property":"packet.cmd","propertyType":"msg","rules":[{"t":"eq","v":"Login success","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1450,"y":800,"wires":[["4de4e285.2b2cfc","c59e9d04.41aa","7710df73.6464d"]]},{"id":"bd49918e.ed383","type":"ui_ui_control","z":"4e472904.6e8aa8","name":"","x":1880,"y":800,"wires":[[]]},{"id":"4de4e285.2b2cfc","type":"function","z":"4e472904.6e8aa8","name":"change","func":"msg.payload = {\"tab\":\"Transaction\"}\nreturn msg;","outputs":1,"noerr":0,"x":1600,"y":800,"wires":[["456741a4.6e72a"]]},{"id":"456741a4.6e72a","type":"delay","z":"4e472904.6e8aa8","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1740,"y":800,"wires":[["bd49918e.ed383"]]},{"id":"f80e2ab.6568bd8","type":"ui_button","z":"4e472904.6e8aa8","name":"","group":"753ed078.f7259","order":5,"width":"3","height":"1","passthru":false,"label":"Forget password","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":150,"y":1020,"wires":[[]]},{"id":"22b87c3a.46ac44","type":"ui_text","z":"4e472904.6e8aa8","group":"fbb122c3.1f54","order":1,"width":0,"height":0,"name":"","label":"You are logging with:","format":"{{msg.payload}}","layout":"row-spread","x":600,"y":1860,"wires":[]},{"id":"cb23b64e.9ade08","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"user_login","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":340,"y":1860,"wires":[["22b87c3a.46ac44"]]},{"id":"6969c4d7.e8479c","type":"ui_ui_control","z":"4e472904.6e8aa8","name":"","x":140,"y":1860,"wires":[["cb23b64e.9ade08"]]},{"id":"6e6873c0.c7831c","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"user_login","pt":"flow","to":"\"\"","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":310,"y":1960,"wires":[["ba79e08e.c87bf","e63248e0.ca7158"]]},{"id":"1ee27ad3.9838b5","type":"ui_button","z":"4e472904.6e8aa8","name":"","group":"fbb122c3.1f54","order":2,"width":0,"height":0,"passthru":false,"label":"Logout","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":130,"y":1960,"wires":[["6e6873c0.c7831c"]]},{"id":"ba79e08e.c87bf","type":"function","z":"4e472904.6e8aa8","name":"hide signout","func":"status = msg.payload\nmsg.payload = {\"tabs\": {\"hide\": \"Sign out\"}}\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":1940,"wires":[["cb80f339.2571d","39b06891.58d768"]]},{"id":"e63248e0.ca7158","type":"function","z":"4e472904.6e8aa8","name":"show login","func":"msg.payload = {\"tabs\": {\"show\": \"Sign in\"}}\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":1980,"wires":[["cb80f339.2571d","6be3e39b.213c2c"]]},{"id":"cb80f339.2571d","type":"ui_ui_control","z":"4e472904.6e8aa8","name":"","x":660,"y":1960,"wires":[[]]},{"id":"39b06891.58d768","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":670,"y":1920,"wires":[]},{"id":"6be3e39b.213c2c","type":"function","z":"4e472904.6e8aa8","name":"change to sign in","func":"msg.payload = {\"tab\":\"Sign in\"}\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":2000,"wires":[["27b62476.58c62c"]]},{"id":"27b62476.58c62c","type":"ui_ui_control","z":"4e472904.6e8aa8","name":"","x":880,"y":2000,"wires":[[]]},{"id":"7710df73.6464d","type":"function","z":"4e472904.6e8aa8","name":"hide","func":"status = msg.payload\nmsg.payload = {\"tabs\": {\"hide\": \"Sign in\"}}\nreturn msg;","outputs":1,"noerr":0,"x":1590,"y":860,"wires":[["b2595601.fc40a8","80e581ee.c3fcc"]]},{"id":"c59e9d04.41aa","type":"function","z":"4e472904.6e8aa8","name":"show","func":"status = msg.payload\nmsg.payload = {\"tabs\": {\"show\": \"Sign out\"}}\nreturn msg;","outputs":1,"noerr":0,"x":1590,"y":900,"wires":[["b2595601.fc40a8"]]},{"id":"b2595601.fc40a8","type":"ui_ui_control","z":"4e472904.6e8aa8","name":"","x":1780,"y":880,"wires":[[]]},{"id":"80e581ee.c3fcc","type":"debug","z":"4e472904.6e8aa8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1790,"y":840,"wires":[]},{"id":"1a42338a.d64d3c","type":"inject","z":"4e472904.6e8aa8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":150,"y":2080,"wires":[["3fe5925a.8b216e"]]},{"id":"3fe5925a.8b216e","type":"change","z":"4e472904.6e8aa8","name":"","rules":[{"t":"set","p":"user_login","pt":"flow","to":"\"\"","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":350,"y":2080,"wires":[["7750809a.70d3e"]]},{"id":"7750809a.70d3e","type":"switch","z":"4e472904.6e8aa8","name":"","property":"user_login","propertyType":"flow","rules":[{"t":"nempty"},{"t":"empty"}],"checkall":"true","repair":false,"outputs":2,"x":290,"y":2020,"wires":[["e63248e0.ca7158"],["ba79e08e.c87bf"]]},{"id":"ef0bce18.5764a","type":"inject","z":"4e472904.6e8aa8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":1440,"y":960,"wires":[["c59e9d04.41aa"]]},{"id":"97776fd3.6b0ac","type":"ui_group","z":"","name":"Scan in local","tab":"7565d072.90331","disp":true,"width":"6","collapse":false},{"id":"de7fa929.04a868","type":"ui_group","z":"","name":"Registered account","tab":"792770ef.665c5","order":2,"disp":true,"width":"6","collapse":false},{"id":"753ed078.f7259","type":"ui_group","z":"","name":"Login account","tab":"e2f8addd.911e4","order":1,"disp":true,"width":"6","collapse":false},{"id":"6e09eb8b.2384d4","type":"ui_group","z":"","name":"Transaction","tab":"e3a476f1.1427a8","order":1,"disp":true,"width":"6","collapse":false},{"id":"6dab62ed.cafdcc","type":"mqtt-broker","z":"","name":"","broker":"209.97.173.222","port":"8883","tls":"","clientid":"","usetls":true,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"374a5c6a.9a5f24","type":"mqtt-broker","z":"","name":"","broker":"209.97.173.222","port":"8883","tls":"","clientid":"","usetls":true,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"7b2d6644.1dbe08","type":"mqtt-broker","z":"","name":"","broker":"178.128.56.80","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"elefos_server_client","type":"mqtt-broker","z":"","name":"","broker":"209.97.173.222","port":"8883","tls":"","clientid":"","usetls":true,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"fbb122c3.1f54","type":"ui_group","z":"","name":"Logout accout","tab":"5c361447.55b75c","order":1,"disp":true,"width":"6","collapse":false},{"id":"7565d072.90331","type":"ui_tab","z":"","name":"Scan IP","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"792770ef.665c5","type":"ui_tab","z":"","name":"Sign up","icon":"dashboard","order":2,"disabled":false,"hidden":false},{"id":"e2f8addd.911e4","type":"ui_tab","z":"","name":"Sign in","icon":"work","order":3,"disabled":false,"hidden":false},{"id":"e3a476f1.1427a8","type":"ui_tab","z":"","name":"Transaction","icon":"work","order":5,"disabled":false,"hidden":false},{"id":"5c361447.55b75c","type":"ui_tab","z":"","name":"Sign out","icon":"dashboard","order":4,"disabled":false,"hidden":false}]